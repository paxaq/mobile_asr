<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Jason's ASR</title>
  <style>
    :root {
      color-scheme: light;
      --bg: #f5f5f7;
      --card: rgba(255,255,255,0.86);
      --text: #1c1c1e;
      --muted: #6b6b70;
      --accent: #0a84ff;
      --border: #e4e4e7;
      --shadow: 0 12px 30px rgba(0,0,0,0.08);
      --glass: blur(18px) saturate(140%);
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "SF Pro Display", system-ui, Segoe UI, Roboto, sans-serif;
      background: var(--bg);
      color: var(--text);
      font-size: 16px;
      margin: 0;
      padding: 20px 16px 32px;
    }
    .app {
      max-width: 880px;
      margin: 0 auto;
    }
    .header {
      margin-bottom: 16px;
    }
    .title {
      font-size: 30px;
      font-weight: 700;
      margin: 0 0 6px 0;
    }
    .subtitle {
      color: var(--muted);
      margin: 0;
      font-size: 15px;
      line-height: 1.4;
    }
    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 16px;
      box-shadow: var(--shadow);
      backdrop-filter: var(--glass);
      margin-bottom: 14px;
    }
    .field {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }
    label {
      font-size: 14px;
      color: var(--muted);
    }
    select, input[type="text"] {
      padding: 8px 12px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: #fff;
      font-size: 15px;
    }
    input[type="checkbox"] {
      transform: scale(1.1);
      accent-color: var(--accent);
    }
    .controls {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .font-controls {
      display: flex;
      gap: 6px;
      align-items: center;
      margin-left: auto;
    }
    .font-controls button {
      padding: 6px 10px;
      font-size: 13px;
      border-radius: 10px;
    }
    button {
      padding: 10px 16px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: #fff;
      font-weight: 600;
      font-size: 15px;
      transition: transform 120ms ease, box-shadow 120ms ease, background 120ms ease;
    }
    button.primary {
      background: var(--accent);
      border-color: var(--accent);
      color: #fff;
    }
    button:hover {
      box-shadow: 0 6px 16px rgba(0,0,0,0.08);
      transform: translateY(-1px);
    }
    button:disabled {
      opacity: 0.5;
    }
    .section-title {
      margin: 0 0 8px 0;
      font-size: 16px;
      font-weight: 600;
    }
    #transcript {
      white-space: pre-wrap;
      background: #fff8ea;
      padding: 14px;
      border-radius: 14px;
      min-height: 120px;
      border: 1px solid #ffe4c4;
      line-height: 1.6;
      font-size: 16px;
    }
    .live-row {
      display: flex;
      align-items: baseline;
      gap: 8px;
      padding: 10px 12px;
      border-radius: 12px;
      background: #fff1d6;
      border: 1px solid #ffd9a6;
      margin-bottom: 10px;
      font-weight: 600;
      min-height: 56px;
    }
    .live-badge {
      font-size: 11px;
      letter-spacing: 0.4px;
      color: #fff;
      background: #ff9f0a;
      padding: 2px 6px;
      border-radius: 6px;
    }
    .history-list {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .history-item {
      padding: 8px 10px;
      border-radius: 10px;
      background: #fffdf6;
      border: 1px solid #ffe9c5;
    }
    #translatedScript {
      width: 100%;
      line-height: 1.35;
      height: 120em;
      padding: 14px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: #f5f7ff;
      font-size: 15px;
      color: var(--text);
    }
    .hint {
      color: var(--muted);
      font-size: 13px;
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="header">
      <h1 class="title">Jason's ASR</h1>
      <p class="subtitle">Real-time speech recognition and translation for iPhone Safari. Tap Start to grant microphone access. Gummy supports translation.</p>
    </div>

    <div class="card">
      <div class="field">
        <label for="modelSelect">Model</label>
        <select id="modelSelect">
          <option value="gummy-realtime-v1" selected>gummy-realtime-v1</option>
          <option value="fun-asr-realtime">fun-asr-realtime</option>
        </select>
        <span class="hint" id="translationHint">Fun-ASR is recognition-only. Gummy supports translation.</span>
      </div>
      <div class="field" style="margin-top:10px;">
        <label for="translationEnabled">Translation</label>
        <input id="translationEnabled" type="checkbox" checked />
        <label for="translationTarget" class="hint">Target</label>
        <input id="translationTarget" type="text" value="zh" style="width:90px" />
        <span class="hint">Targets: zh, en, ja, ko, yue, de, fr, ru, es, it, pt, id, ar, th, hi, da, ur, tr, nl, ms, vi</span>
      </div>
      <div class="field" style="margin-top:10px;">
        <label for="ttsEnabled">TTS</label>
        <input id="ttsEnabled" type="checkbox" checked />
        <label for="ttsModel" class="hint">Model</label>
        <select id="ttsModel">
          <option value="qwen3-tts-flash-realtime" selected>qwen3-tts-flash-realtime</option>
          <option value="browser-tts">browser-tts</option>
        </select>
        <label for="ttsVoice" class="hint">Voice</label>
        <select id="ttsVoice">
          <option value="Cherry" selected>Cherry</option>
          <option value="Serena">Serena</option>
          <option value="Ethan">Ethan</option>
          <option value="Chelsie">Chelsie</option>
          <option value="Momo">Momo</option>
        </select>
        <span class="hint">Real-time playback uses browser voices in this demo.</span>
      </div>
    </div>

    <div class="card">
      <div class="controls">
        <button id="btnStart" class="primary">Start</button>
        <button id="btnPause" disabled>Pause</button>
        <button id="btnStop" disabled>Stop</button>
      </div>
      <p class="hint" style="margin-top:10px;">Safari requires a user gesture to start the microphone. Keep the page in the foreground for best results. Use HTTPS on iPhone.</p>
      <p class="hint" id="micStatus"></p>
    </div>

    <div class="card">
      <div class="field" style="justify-content: space-between; align-items: center;">
        <h3 class="section-title" style="margin:0;">Transcript (live + last 5 final)</h3>
        <div class="font-controls">
          <label class="hint">Font</label>
          <button id="btnTranscriptFontDown" type="button">A-</button>
          <button id="btnTranscriptFontUp" type="button">A+</button>
        </div>
      </div>
      <div id="transcript">
        <div class="live-row">
          <span class="live-badge">LIVE</span>
          <span id="transcriptLive">Waiting for speechâ€¦</span>
        </div>
        <div class="history-list" id="transcriptHistory"></div>
      </div>
    </div>

    <div class="card">
      <div class="controls" style="margin-bottom:10px; align-items: center;">
        <button id="btnDownloadTranslated">Download Translated TXT</button>
        <div class="font-controls">
          <label class="hint">Font</label>
          <button id="btnTranslatedFontDown" type="button">A-</button>
          <button id="btnTranslatedFontUp" type="button">A+</button>
        </div>
      </div>
      <h3 class="section-title">Long Transcript (all items)</h3>
      <textarea id="translatedScript" rows="100" readonly></textarea>
    </div>

    <div class="card">
      <h3 class="section-title">Supported languages</h3>
      <p class="hint">ASR: zh, en, ja, ko, yue, de, fr, ru, es, it, pt, id, ar, th</p>
      <p class="hint">Translation targets (examples): en, zh, ja, ko, fr, de, es, ru, it, pt, vi, nl, da, ar, hi, yue, tr, ms, ur, id, th</p>
    </div>
  </div>
  <script type="module" src="/src/main.js"></script>
</body>
</html>
